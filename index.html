<!DOCTYPE html>
<html lang="en">

<head>
    <title>Aqua Drain and Waterworks</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/site.css" rel="stylesheet" type="text/css">
</head>

<body>
    <table id="headersTable">
        <tr>
            <td rowspan="3">
                <img id="logo" 
                     src="images/logo.svg"/>
            </td>
            <td id="phoneCell"
                colspan="6">
                <img id="labelMapleLeaf"
                    src="images/mapleLeaf.svg" />
                <span id="labelCallWorld"
                   class="phoneLabel">CALL</span>
                <span id="labelPhone"
                   class="phoneLabel">647 979 3347</span>
            </td>
        </tr>
        <tr>
            <td class="headerLabelCell">DRAIN</td>
            <td class="headerLabelCell">WATER SERVICE</td>
            <td class="headerLabelCell">WATERPROOFING</td>
            <td class="headerLabelCell">EMERGENCY PLUMBING</td>
            <td class="headerLabelCell">PROMOTION</td>
        </tr>
        <tr>
            <td />
            <td />
            <td />
            <td />
            <td />
        </tr>
    </table>

    <script>
        $(document)
            .ready(function () {

                // Add smooth scrolling to all links in navbar + footer link
                $(".navbar a, footer a[href='#myPage']")
                    .on('click',
                    function (event) {
                        // Make sure this.hash has a value before overriding default behavior
                        if (this.hash !== "") {
                            // Prevent default anchor click behavior
                            event.preventDefault();

                            // Store hash
                            var hash = this.hash;

                            // Using jQuery's animate() method to add smooth page scroll
                            // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
                            $('html, body')
                                .animate({
                                    scrollTop: $(hash).offset().top
                                },
                                900,
                                function () {

                                    // Add hash (#) to URL when done scrolling (default click behavior)
                                    window.location.hash = hash;
                                });
                        } // End if
                    });

                $(window)
                    .scroll(function () {
                        $(".slideanim")
                            .each(function () {
                                var pos = $(this).offset().top;

                                var winTop = $(window).scrollTop();
                                if (pos < winTop + 600) {
                                    $(this).addClass("slide");
                                }
                            });
                    });

                $('form')
                    .submit(function (event) {
                        event.preventDefault();

                        var data = {
                            Name: $('#name').val(),
                            Phone: $('#phone').val(),
                            Email: $('#email').val(),
                            Comments: $('#comments').val()
                        };

                        $(function () {
                            $("#btnSubmit").prop("disabled", true);
                            $("#btnSubmit").button('loading');
                        });

                        $.ajax({
                            type: "POST",
                            url: "http://aquadrainservice.azurewebsites.net/api/estimate",
                            data: { "name": $("#name").val(), "phone": $("#phone").val(), "email": $("#email").val(), "comments": $("#comments").val() },
                            crossDomain: true,
                            success: function (msg) {
                                $("#alertSuccess").alert();

                                if (msg.success) {
                                    $('#formComment').trigger('reset');
                                    $("#modalSuccess").modal();
                                } else {
                                    if (msg.hasOwnProperty("internalError")) {
                                        console.log(msg.internalError + " " + msg.errors.join(";"));
                                        $("#modalInternalError").modal();
                                    }
                                    else {
                                        var list = $("#listValidateErrors");
                                        list.empty();

                                        for (var i = 0; i < msg.errors.length; i++)
                                            list.append("<li>" + msg.errors[i] + "</li>");

                                        $("#modalValidationError").modal();
                                    }
                                }

                                console.log("receive success");
                            },
                            error: function (msg) {
                                $("#modalInternalError").modal();
                                console.log("receive error");
                            },
                            complete: function (msg) {
                                $("#btnSubmit").prop("disabled", false);
                                $("#btnSubmit").button('reset');
                                console.log("receive complete");
                            }
                        });
                    });

            })
    </script>

</body>

</html>